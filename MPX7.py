from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import (
    ApplicationBuilder,
    ContextTypes,
    CommandHandler,
    MessageHandler,
    CallbackQueryHandler,
    filters
)
import logging
from typing import Dict, Set

# -------------------- CONFIGURATION --------------------
TOKEN = "7520847694:AAGXLKTvD0dHU2nyaGmCuN0DovelGHHr5Pg"
ADMIN_IDS = {"5524867269", "6213264970"}
banned_users: Set[str] = set()
user_lang: Dict[str, str] = {}
forward_map: Dict[int, int] = {}

# -------------------- LOGGER --------------------
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

# -------------------- LANGUAGES --------------------
LANGUAGES = {
    "hindi": {
        "welcome": "ЁЯЗоЁЯЗ│ рдирдорд╕реНрддреЗ! рдЕрдм рдЖрдк рдлреАрдбрдмреИрдХ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред ЁЯШК",
        "full_welcome": (
            "ЁЯЪА SkullCheat Feedback Bot рдореЗрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИ!\n\n"
            "ЁЯУв рдЪреИрдирд▓: @Skull_Cheats\n"
            "ЁЯСд рдбреЗрд╡рд▓рдкрд░: @SkullModOwner\n"
            "ЁЯУд рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рднреЗрдЬреЗрдВ: @SkullCheat_FileBot\n\n"
            "тЪая╕П рдзреНрдпрд╛рди рджреЗрдВ: рдмрд┐рдирд╛ рдлреАрдбрдмреИрдХ рдХреЗ рдХреЛрдИ Key рдирд╣реАрдВ рдорд┐рд▓реЗрдЧреА! ЁЯФС"
        ),
        "user": "ЁЯСд рдпреВрдЬрд░ рдбреИрд╢рдмреЛрд░реНрдб\n\nЁЯЖФ ID: {user_id}\nЁЯМР рднрд╛рд╖рд╛: {lang}\nЁЯЪл рдмреИрди: {banned}\nЁЯСе рдХреБрд▓ рдпреВрдЬрд░: {total}",
        "banned": "ЁЯЪл рдЖрдк рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реИрдВред рдХреЛрдИ рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВред",
        "language_set": "тЬЕ рднрд╛рд╖рд╛ рд╕реЗрдЯ рд╣реЛ рдЧрдИ рд╣реИ!\n\n{message}",
        "unauthorized": "тЭМ рдЖрдк рдЕрдзрд┐рдХреГрдд рдирд╣реАрдВ рд╣реИрдВред",
        "ban_success": "ЁЯЪл рдпреВрдЬрд░ {user_id} рдХреЛ рдмреИрди рдХрд┐рдпрд╛ рдЧрдпрд╛ред",
        "unban_success": "тЬЕ рдпреВрдЬрд░ {user_id} рдХрд╛ рдмреИрди рд╣рдЯрд╛рдпрд╛ рдЧрдпрд╛ред",
        "broadcast_result": "ЁЯУв рд╕рдВрджреЗрд╢ {count} рдпреВрдЬрд░реНрд╕ рдХреЛ рднреЗрдЬрд╛ рдЧрдпрд╛, {failed} рдЕрд╕рдлрд▓ рд░рд╣реЗред",
        "admin_reply_prefix": "ЁЯТм рдПрдбрдорд┐рди рдХрд╛ рдЬрд╡рд╛рдм:\n\n",
        "reply_success": "тЬЕ рд╕рдВрджреЗрд╢ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рднреЗрдЬрд╛ рдЧрдпрд╛!",
        "reply_failed": "тЭМ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓ред",
        "invalid_format": "тЪая╕П рдлреЙрд░реНрдореЗрдЯ рд╕рдкреЛрд░реНрдЯ рдирд╣реАрдВ рд╣реИред",
        "user_not_found": "тЪая╕П рдореВрд▓ рдпреВрдЬрд░ рдирд╣реАрдВ рдорд┐рд▓рд╛ред",
        "reply_instructions": "тЭМ рдХреГрдкрдпрд╛ рдпреВрдЬрд░ рдХреЗ рд╕рдВрджреЗрд╢ рдкрд░ рд░рд┐рдкреНрд▓рд╛рдИ рдХрд░реЗрдВред",
        "commands": (
            "ЁЯУЪ рдЙрдкрд▓рдмреНрдз рдХрдорд╛рдВрдбреНрд╕:\n\n"
            "ЁЯЪА /start - рдмреЛрдЯ рд╢реБрд░реВ рдХрд░реЗрдВ\n"
            "ЁЯСд /user - рдЕрдкрдиреА рдЬрд╛рдирдХрд╛рд░реА рджреЗрдЦреЗрдВ\n"
            "ЁЯМР /language - рднрд╛рд╖рд╛ рдмрджрд▓реЗрдВ\n"
            "ЁЯУЭ /feedback - рдлреАрдбрдмреИрдХ рднреЗрдЬреЗрдВ\n"
            "тЭУ /help - рдорджрдж рджреЗрдЦреЗрдВ\n\n"
            "ЁЯФи рдПрдбрдорд┐рди рдХрдорд╛рдВрдбреНрд╕:\n"
            "ЁЯЪл /ban <user_id> - рдпреВрдЬрд░ рдХреЛ рдмреИрди рдХрд░реЗрдВ\n"
            "тЬЕ /unban <user_id> - рдпреВрдЬрд░ рдХрд╛ рдмреИрди рд╣рдЯрд╛рдПрдВ\n"
            "ЁЯУв /broadcast - рд╕рднреА рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬреЗрдВ\n"
            "ЁЯУЬ /commands - рд╕рднреА рдХрдорд╛рдВрдбреНрд╕ рджреЗрдЦреЗрдВ"
        ),
        "help": (
            "ЁЯЖШ рдорджрдж рдХреЗрдВрджреНрд░\n\n"
            "1. рдлреАрдбрдмреИрдХ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ рд╕рдВрджреЗрд╢ рд▓рд┐рдЦреЗрдВ рдпрд╛ рдореАрдбрд┐рдпрд╛ рднреЗрдЬреЗрдВ\n"
            "2. рднрд╛рд╖рд╛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП /language рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ\n"
            "3. рдЕрдкрдиреА рдЬрд╛рдирдХрд╛рд░реА рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП /user рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ\n\n"
            "рд╕рдорд╕реНрдпрд╛рдПрдВ? @SkullModOwner рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдВ"
        )
    },
    "english": {
        "welcome": "ЁЯЗ║ЁЯЗ╕ Hello! You can now send your feedback. ЁЯСН",
        "full_welcome": (
            "ЁЯЪА Welcome to SkullCheat Feedback Bot!\n\n"
            "ЁЯУв Channel: @Skull_Cheats\n"
            "ЁЯСд Developer: @SkullModOwner\n"
            "ЁЯУд Send Screenshots: @SkullCheat_FileBot\n\n"
            "тЪая╕П Note: You won't get any key without feedback! ЁЯФС"
        ),
        "user": "ЁЯСд User Dashboard\n\nЁЯЖФ ID: {user_id}\nЁЯМР Language: {lang}\nЁЯЪл Banned: {banned}\nЁЯСе Total Users: {total}",
        "banned": "ЁЯЪл You are banned. No actions allowed.",
        "language_set": "тЬЕ Language set!\n\n{message}",
        "unauthorized": "тЭМ Unauthorized.",
        "ban_success": "ЁЯЪл User {user_id} banned.",
        "unban_success": "тЬЕ User {user_id} unbanned.",
        "broadcast_result": "ЁЯУв Message sent to {count} users, {failed} failed.",
        "admin_reply_prefix": "ЁЯТм Admin reply:\n\n",
        "reply_success": "тЬЕ Message sent successfully!",
        "reply_failed": "тЭМ Failed to send message.",
        "invalid_format": "тЪая╕П Format not supported.",
        "user_not_found": "тЪая╕П Original user not found.",
        "reply_instructions": "тЭМ Please reply to user's message.",
        "commands": (
            "ЁЯУЪ Available Commands:\n\n"
            "ЁЯЪА /start - Start the bot\n"
            "ЁЯСд /user - Show your info\n"
            "ЁЯМР /language - Change language\n"
            "ЁЯУЭ /feedback - Send feedback\n"
            "тЭУ /help - Show help\n\n"
            "ЁЯФи Admin Commands:\n"
            "ЁЯЪл /ban <user_id> - Ban a user\n"
            "тЬЕ /unban <user_id> - Unban a user\n"
            "ЁЯУв /broadcast - Broadcast message\n"
            "ЁЯУЬ /commands - Show all commands"
        ),
        "help": (
            "ЁЯЖШ Help Center\n\n"
            "1. To send feedback, just type your message or send media\n"
            "2. Use /language command to change language\n"
            "3. Use /user command to see your info\n\n"
            "Problems? Contact @SkullModOwner"
        )
    },
    "urdu": {
        "welcome": "ЁЯЗ╡ЁЯЗ░ █Б█М┘Д┘И! ╪з╪и ╪в┘╛ ╪з┘╛┘Ж╪з ┘Б█М┌И ╪и█М┌й ╪и┌╛█М╪м ╪│┌й╪к█Т █Б█М┌║█Ф",
        "full_welcome": (
            "ЁЯЪА ╪з╪│┌й┘Д ┌Ж█М┘╣ ┘Б█М┌И ╪и█М┌й ╪и┘И┘╣ ┘Е█М┌║ ╪о┘И╪┤ ╪в┘Е╪п█М╪п!\n\n"
            "ЁЯУв ┌Ж█М┘Ж┘Д: @Skull_Cheats\n"
            "ЁЯСд ┌И┘И█М┘Д┘╛╪▒: @SkullModOwner\n"
            "ЁЯУд ╪з╪│┌й╪▒█М┘Ж ╪┤╪з┘╣╪│ ╪и┌╛█М╪м█М┌║: @SkullCheat_FileBot\n\n"
            "тЪая╕П ┘Ж┘И┘╣: ┘Б█М┌И ╪и█М┌й ┌й█Т ╪и╪║█М╪▒ ┌й┘И╪ж█М ┌й┘Д█М╪п ┘Ж█Б█М┌║ ┘Е┘Д█Т ┌п█М! ЁЯФС"
        ),
        "user": "ЁЯСд █М┘И╪▓╪▒ ┌И█М╪┤ ╪и┘И╪▒┌И\n\nЁЯЖФ ID: {user_id}\nЁЯМР ╪▓╪и╪з┘Ж: {lang}\nЁЯЪл ┘╛╪з╪и┘Ж╪п█М: {banned}\nЁЯСе ┌й┘Д ╪╡╪з╪▒┘Б█М┘Ж: {total}",
        "banned": "ЁЯЪл ╪в┘╛ ┘╛╪▒ ┘╛╪з╪и┘Ж╪п█М ╪╣╪з╪ж╪п █Б█Т█Ф ┌й┘И╪ж█М ┌й╪з╪▒╪▒┘И╪з╪ж█М ┘Ж█Б█М┌║█Ф",
        "language_set": "тЬЕ ╪▓╪и╪з┘Ж ╪│█М┘╣ █Б┘И ┌п╪ж█М!\n\n{message}",
        "unauthorized": "тЭМ ╪║█М╪▒ ┘Е╪м╪з╪▓█Ф",
        "ban_success": "ЁЯЪл ╪╡╪з╪▒┘Б {user_id} ┘╛╪▒ ┘╛╪з╪и┘Ж╪п█М ┘Д┌п╪з ╪п█М ┌п╪ж█М█Ф",
        "unban_success": "тЬЕ ╪╡╪з╪▒┘Б {user_id} ┌й█М ┘╛╪з╪и┘Ж╪п█М █Б┘╣╪з ╪п█М ┌п╪ж█М█Ф",
        "broadcast_result": "ЁЯУв ┘╛█М╪║╪з┘Е {count} ╪╡╪з╪▒┘Б█М┘Ж ┌й┘И ╪и┌╛█М╪м╪з ┌п█М╪з╪М {failed} ┘Ж╪з┌й╪з┘Е █Б┘И╪ж█Т█Ф",
        "admin_reply_prefix": "ЁЯТм ╪з█М┌И┘Е┘Ж ┌й╪з ╪м┘И╪з╪и:\n\n",
        "reply_success": "тЬЕ ┘╛█М╪║╪з┘Е ┌й╪з┘Е█М╪з╪и█М ╪│█Т ╪и┌╛█М╪м ╪п█М╪з ┌п█М╪з!",
        "reply_failed": "тЭМ ┘╛█М╪║╪з┘Е ╪и┌╛█М╪м┘Ж█Т ┘Е█М┌║ ┘Ж╪з┌й╪з┘Е█Ф",
        "invalid_format": "тЪая╕П ┘Б╪з╪▒┘Е█М┘╣ ╪│┘╛┘И╪▒┘╣ ┘Ж█Б█М┌║ ┌й█М╪з ┌п█М╪з█Ф",
        "user_not_found": "тЪая╕П ╪з╪╡┘Д ╪╡╪з╪▒┘Б ┘Ж█Б█М┌║ ┘Е┘Д╪з█Ф",
        "reply_instructions": "тЭМ ╪и╪▒╪з█Б ┌й╪▒┘Е ╪╡╪з╪▒┘Б ┌й█Т ┘╛█М╪║╪з┘Е ┌й╪з ╪м┘И╪з╪и ╪п█М┌║█Ф",
        "commands": (
            "ЁЯУЪ ╪п╪│╪к█М╪з╪и ┌й┘Е╪з┘Ж┌И╪▓:\n\n"
            "ЁЯЪА /start - ╪и┘И┘╣ ╪┤╪▒┘И╪╣ ┌й╪▒█М┌║\n"
            "ЁЯСд /user - ╪з┘╛┘Ж█М ┘Е╪╣┘Д┘И┘Е╪з╪к ╪п█М┌й┌╛█М┌║\n"
            "ЁЯМР /language - ╪▓╪и╪з┘Ж ╪к╪и╪п█М┘Д ┌й╪▒█М┌║\n"
            "ЁЯУЭ /feedback - ┘Б█М┌И ╪и█М┌й ╪и┌╛█М╪м█М┌║\n"
            "тЭУ /help - ┘Е╪п╪п ╪п█М┌й┌╛█М┌║\n\n"
            "ЁЯФи ╪з█М┌И┘Е┘Ж ┌й┘Е╪з┘Ж┌И╪▓:\n"
            "ЁЯЪл /ban <user_id> - ╪╡╪з╪▒┘Б ┘╛╪▒ ┘╛╪з╪и┘Ж╪п█М ┘Д┌п╪з╪ж█М┌║\n"
            "тЬЕ /unban <user_id> - ╪╡╪з╪▒┘Б ┌й█М ┘╛╪з╪и┘Ж╪п█М █Б┘╣╪з╪ж█М┌║\n"
            "ЁЯУв /broadcast - ╪к┘Е╪з┘Е ┌й┘И ┘╛█М╪║╪з┘Е ╪и┌╛█М╪м█М┌║\n"
            "ЁЯУЬ /commands - ╪к┘Е╪з┘Е ┌й┘Е╪з┘Ж┌И╪▓ ╪п█М┌й┌╛█М┌║"
        ),
        "help": (
            "ЁЯЖШ █Б█М┘Д┘╛ ╪│█М┘Ж┘╣╪▒\n\n"
            "1. ┘Б█М┌И ╪и█М┌й ╪и┌╛█М╪м┘Ж█Т ┌й█Т ┘Д█М█Т ╪и╪▒╪з█Б ╪▒╪з╪│╪к ┘╛█М╪║╪з┘Е ┘Д┌й┌╛█М┌║ █М╪з ┘Е█М┌И█М╪з ╪и┌╛█М╪м█М┌║\n"
            "2. ╪▓╪и╪з┘Ж ╪к╪и╪п█М┘Д ┌й╪▒┘Ж█Т ┌й█Т ┘Д█М█Т /language ┌й┘Е╪з┘Ж┌И ╪з╪│╪к╪╣┘Е╪з┘Д ┌й╪▒█М┌║\n"
            "3. ╪з┘╛┘Ж█М ┘Е╪╣┘Д┘И┘Е╪з╪к ╪п█М┌й┌╛┘Ж█Т ┌й█Т ┘Д█М█Т /user ┌й┘Е╪з┘Ж┌И ╪з╪│╪к╪╣┘Е╪з┘Д ┌й╪▒█М┌║\n\n"
            "┘Е╪│╪з╪ж┘Д╪Я @SkullModOwner ╪│█Т ╪▒╪з╪и╪╖█Б ┌й╪▒█М┌║"
        )
    },
    "chinese": {
        "welcome": "ЁЯЗиЁЯЗ│ ф╜ахе╜я╝БцВичО░хЬихПпф╗ехПСщАБхПНщжИф║ЖуАВ",
        "full_welcome": (
            "ЁЯЪА цмвш┐Оф╜┐чФиSkullCheatхПНщжИцЬ║хЩиф║║!\n\n"
            "ЁЯУв щвСщБУ: @Skull_Cheats\n"
            "ЁЯСд х╝АхПСшАЕ: @SkullModOwner\n"
            "ЁЯУд хПСщАБцИкхЫ╛: @SkullCheat_FileBot\n\n"
            "тЪая╕П ц│ицДП: ц▓бцЬЙхПНщжИх░Жф╕Нф╝ЪшО╖х╛Чф╗╗ф╜ХхпЖщТе! ЁЯФС"
        ),
        "user": "ЁЯСд чФицИ╖щЭвцЭ┐\n\nЁЯЖФ ID: {user_id}\nЁЯМР шпншиА: {lang}\nЁЯЪл х░БчжБ: {banned}\nЁЯСе цА╗чФицИ╖: {total}",
        "banned": "ЁЯЪл цВих╖▓швлх░БчжБуАВф╕НхЕБшо╕ф╗╗ф╜ХцУНф╜ЬуАВ",
        "language_set": "тЬЕ шпншиАшо╛ч╜оцИРхКЯ!\n\n{message}",
        "unauthorized": "тЭМ цЬкч╗ПцОИцЭГуАВ",
        "ban_success": "ЁЯЪл чФицИ╖ {user_id} х╖▓швлх░БчжБуАВ",
        "unban_success": "тЬЕ чФицИ╖ {user_id} х╖▓шзгх░БуАВ",
        "broadcast_result": "ЁЯУв ц╢ИцБпх╖▓хПСщАБч╗Щ {count} чФицИ╖, {failed} хд▒ш┤еуАВ",
        "admin_reply_prefix": "ЁЯТм чобчРЖхСШхЫЮхдН:\n\n",
        "reply_success": "тЬЕ ц╢ИцБпхПСщАБцИРхКЯ!",
        "reply_failed": "тЭМ хПСщАБц╢ИцБпхд▒ш┤еуАВ",
        "invalid_format": "тЪая╕П ф╕НцФпцМБцндца╝х╝ПуАВ",
        "user_not_found": "тЪая╕П цЬкцЙ╛хИ░хОЯхзЛчФицИ╖уАВ",
        "reply_instructions": "тЭМ шп╖хЫЮхдНчФицИ╖чЪДц╢ИцБпуАВ",
        "commands": (
            "ЁЯУЪ хПпчФихС╜ф╗д:\n\n"
            "ЁЯЪА /start - хРпхКицЬ║хЩиф║║\n"
            "ЁЯСд /user - цЯечЬЛцВичЪДф┐бцБп\n"
            "ЁЯМР /language - цЫ┤цФ╣шпншиА\n"
            "ЁЯУЭ /feedback - хПСщАБхПНщжИ\n"
            "тЭУ /help - цЯечЬЛх╕охКй\n\n"
            "ЁЯФи чобчРЖхСШхС╜ф╗д:\n"
            "ЁЯЪл /ban <user_id> - х░БчжБчФицИ╖\n"
            "тЬЕ /unban <user_id> - шзгх░БчФицИ╖\n"
            "ЁЯУв /broadcast - х╣┐цТнц╢ИцБп\n"
            "ЁЯУЬ /commands - цЯечЬЛцЙАцЬЙхС╜ф╗д"
        ),
        "help": (
            "ЁЯЖШ х╕охКйф╕нх┐Г\n\n"
            "1. хПСщАБхПНщжИхПкщЬАш╛УхЕецВичЪДц╢ИцБпцИЦхПСщАБхкТф╜У\n"
            "2. ф╜┐чФи/languageхС╜ф╗дцЫ┤цФ╣шпншиА\n"
            "3. ф╜┐чФи/userхС╜ф╗дцЯечЬЛцВичЪДф┐бцБп\n\n"
            "цЬЙщЧощвШ? шБФч│╗ @SkullModOwner"
        )
    },
    "french": {
        "welcome": "ЁЯЗлЁЯЗ╖ Bonjour ! Vous pouvez maintenant envoyer vos commentaires.",
        "full_welcome": (
            "ЁЯЪА Bienvenue sur le bot de feedback SkullCheat !\n\n"
            "ЁЯУв Cha├оne: @Skull_Cheats\n"
            "ЁЯСд D├йveloppeur: @SkullModOwner\n"
            "ЁЯУд Envoyer des captures d'├йcran: @SkullCheat_FileBot\n\n"
            "тЪая╕П Remarque: Vous n'obtiendrez aucune cl├й sans feedback ! ЁЯФС"
        ),
        "user": "ЁЯСд Tableau de bord utilisateur\n\nЁЯЖФ ID: {user_id}\nЁЯМР Langue: {lang}\nЁЯЪл Banni: {banned}\nЁЯСе Total utilisateurs: {total}",
        "banned": "ЁЯЪл Vous ├кtes banni. Aucune action autoris├йe.",
        "language_set": "тЬЕ Langue d├йfinie !\n\n{message}",
        "unauthorized": "тЭМ Non autoris├й.",
        "ban_success": "ЁЯЪл Utilisateur {user_id} banni.",
        "unban_success": "тЬЕ Utilisateur {user_id} d├йbanni.",
        "broadcast_result": "ЁЯУв Message envoy├й ├а {count} utilisateurs, {failed} ├йchecs.",
        "admin_reply_prefix": "ЁЯТм R├йponse de l'admin:\n\n",
        "reply_success": "тЬЕ Message envoy├й avec succ├иs !",
        "reply_failed": "тЭМ ├Йchec de l'envoi du message.",
        "invalid_format": "тЪая╕П Format non pris en charge.",
        "user_not_found": "тЪая╕П Utilisateur original non trouv├й.",
        "reply_instructions": "тЭМ Veuillez r├йpondre au message de l'utilisateur.",
        "commands": (
            "ЁЯУЪ Commandes disponibles:\n\n"
            "ЁЯЪА /start - D├йmarrer le bot\n"
            "ЁЯСд /user - Afficher vos informations\n"
            "ЁЯМР /language - Changer de langue\n"
            "ЁЯУЭ /feedback - Envoyer des commentaires\n"
            "тЭУ /help - Afficher l'aide\n\n"
            "ЁЯФи Commandes admin:\n"
            "ЁЯЪл /ban <user_id> - Bannir un utilisateur\n"
            "тЬЕ /unban <user_id> - D├йbannir un utilisateur\n"
            "ЁЯУв /broadcast - Diffuser un message\n"
            "ЁЯУЬ /commands - Afficher toutes les commandes"
        ),
        "help": (
            "ЁЯЖШ Centre d'aide\n\n"
            "1. Pour envoyer des commentaires, tapez simplement votre message ou envoyez des m├йdias\n"
            "2. Utilisez la commande /language pour changer de langue\n"
            "3. Utilisez la commande /user pour voir vos informations\n\n"
            "Probl├иmes? Contactez @SkullModOwner"
        )
    },
    "spanish": {
        "welcome": "ЁЯЗкЁЯЗ╕ ┬бHola! Ahora puedes enviar tus comentarios.",
        "full_welcome": (
            "ЁЯЪА ┬бBienvenido al bot de comentarios SkullCheat!\n\n"
            "ЁЯУв Canal: @Skull_Cheats\n"
            "ЁЯСд Desarrollador: @SkullModOwner\n"
            "ЁЯУд Enviar capturas de pantalla: @SkullCheat_FileBot\n\n"
            "тЪая╕П Nota: ┬бNo obtendr├бs ninguna clave sin comentarios! ЁЯФС"
        ),
        "user": "ЁЯСд Panel de usuario\n\nЁЯЖФ ID: {user_id}\nЁЯМР Idioma: {lang}\nЁЯЪл Baneado: {banned}\nЁЯСе Total de usuarios: {total}",
        "banned": "ЁЯЪл Est├бs baneado. No se permiten acciones.",
        "language_set": "тЬЕ ┬бIdioma establecido!\n\n{message}",
        "unauthorized": "тЭМ No autorizado.",
        "ban_success": "ЁЯЪл Usuario {user_id} baneado.",
        "unban_success": "тЬЕ Usuario {user_id} desbaneado.",
        "broadcast_result": "ЁЯУв Mensaje enviado a {count} usuarios, {failed} fallidos.",
        "admin_reply_prefix": "ЁЯТм Respuesta del admin:\n\n",
        "reply_success": "тЬЕ ┬бMensaje enviado con ├йxito!",
        "reply_failed": "тЭМ Error al enviar el mensaje.",
        "invalid_format": "тЪая╕П Formato no soportado.",
        "user_not_found": "тЪая╕П Usuario original no encontrado.",
        "reply_instructions": "тЭМ Por favor, responde al mensaje del usuario.",
        "commands": (
            "ЁЯУЪ Comandos disponibles:\n\n"
            "ЁЯЪА /start - Iniciar el bot\n"
            "ЁЯСд /user - Mostrar tu informaci├│n\n"
            "ЁЯМР /language - Cambiar idioma\n"
            "ЁЯУЭ /feedback - Enviar comentarios\n"
            "тЭУ /help - Mostrar ayuda\n\n"
            "ЁЯФи Comandos de admin:\n"
            "ЁЯЪл /ban <user_id> - Banear a un usuario\n"
            "тЬЕ /unban <user_id> - Desbanear a un usuario\n"
            "ЁЯУв /broadcast - Transmitir mensaje\n"
            "ЁЯУЬ /commands - Mostrar todos los comandos"
        ),
        "help": (
            "ЁЯЖШ Centro de ayuda\n\n"
            "1. Para enviar comentarios, simplemente escribe tu mensaje o env├нa medios\n"
            "2. Usa el comando /language para cambiar el idioma\n"
            "3. Usa el comando /user para ver tu informaci├│n\n\n"
            "┬┐Problemas? Contacta a @SkullModOwner"
        )
    },
    "turkish": {
        "welcome": "ЁЯЗ╣ЁЯЗ╖ Merhaba! Art─▒k geri bildirim g├╢nderebilirsiniz.",
        "full_welcome": (
            "ЁЯЪА SkullCheat Geri Bildirim Botuna Ho┼Я Geldiniz!\n\n"
            "ЁЯУв Kanal: @Skull_Cheats\n"
            "ЁЯСд Geli┼Яtirici: @SkullModOwner\n"
            "ЁЯУд Ekran g├╢r├╝nt├╝leri g├╢nderin: @SkullCheat_FileBot\n\n"
            "тЪая╕П Not: Geri bildirim olmadan herhangi bir anahtar alamazs─▒n─▒z! ЁЯФС"
        ),
        "user": "ЁЯСд Kullan─▒c─▒ Paneli\n\nЁЯЖФ ID: {user_id}\nЁЯМР Dil: {lang}\nЁЯЪл Yasakl─▒: {banned}\nЁЯСе Toplam kullan─▒c─▒: {total}",
        "banned": "ЁЯЪл Yasakland─▒n─▒z. Hi├зbir i┼Яleme izin verilmiyor.",
        "language_set": "тЬЕ Dil ayarland─▒!\n\n{message}",
        "unauthorized": "тЭМ Yetkisiz.",
        "ban_success": "ЁЯЪл Kullan─▒c─▒ {user_id} yasakland─▒.",
        "unban_success": "тЬЕ Kullan─▒c─▒ {user_id} yasa─Я─▒ kald─▒r─▒ld─▒.",
        "broadcast_result": "ЁЯУв Mesaj {count} kullan─▒c─▒ya g├╢nderildi, {failed} ba┼Яar─▒s─▒z.",
        "admin_reply_prefix": "ЁЯТм Admin yan─▒t─▒:\n\n",
        "reply_success": "тЬЕ Mesaj ba┼Яar─▒yla g├╢nderildi!",
        "reply_failed": "тЭМ Mesaj g├╢nderilemedi.",
        "invalid_format": "тЪая╕П Desteklenmeyen bi├зim.",
        "user_not_found": "тЪая╕П Orijinal kullan─▒c─▒ bulunamad─▒.",
        "reply_instructions": "тЭМ L├╝tfen kullan─▒c─▒n─▒n mesaj─▒na yan─▒t verin.",
        "commands": (
            "ЁЯУЪ Mevcut komutlar:\n\n"
            "ЁЯЪА /start - Botu ba┼Яlat\n"
            "ЁЯСд /user - Bilgilerini g├╢ster\n"
            "ЁЯМР /language - Dil de─Яi┼Яtir\n"
            "ЁЯУЭ /feedback - Geri bildirim g├╢nder\n"
            "тЭУ /help - Yard─▒m g├╢ster\n\n"
            "ЁЯФи Admin komutlar─▒:\n"
            "ЁЯЪл /ban <user_id> - Kullan─▒c─▒y─▒ yasakla\n"
            "тЬЕ /unban <user_id> - Kullan─▒c─▒ yasa─Я─▒n─▒ kald─▒r\n"
            "ЁЯУв /broadcast - Mesaj yay─▒nla\n"
            "ЁЯУЬ /commands - T├╝m komutlar─▒ g├╢ster"
        ),
        "help": (
            "ЁЯЖШ Yard─▒m Merkezi\n\n"
            "1. Geri bildirim g├╢ndermek i├зin sadece mesaj yaz─▒n veya medya g├╢nderin\n"
            "2. Dil de─Яi┼Яtirmek i├зin /language komutunu kullan─▒n\n"
            "3. Bilgilerinizi g├╢rmek i├зin /user komutunu kullan─▒n\n\n"
            "Sorunlar? @SkullModOwner ile ileti┼Яime ge├зin"
        )
    }
}

# -------------------- HELPER FUNCTIONS --------------------
def get_user_language(user_id: str) -> str:
    """Get user's preferred language, default to English if not set."""
    return user_lang.get(user_id, "english")

def get_message(user_id: str, key: str, **kwargs) -> str:
    """Get localized message for user."""
    lang = get_user_language(user_id)
    return LANGUAGES.get(lang, LANGUAGES["english"]).get(key, "").format(**kwargs)

def is_admin(user_id: str) -> bool:
    """Check if user is admin."""
    return user_id in ADMIN_IDS

def is_banned(user_id: str) -> bool:
    """Check if user is banned."""
    return user_id in banned_users

# -------------------- COMMAND HANDLERS --------------------
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user_id = str(update.effective_user.id)
    
    if is_banned(user_id):
        await update.message.reply_text(get_message(user_id, "banned"))
        return

    keyboard = InlineKeyboardMarkup([
        [InlineKeyboardButton("ЁЯЗоЁЯЗ│ Hindi", callback_data="lang_hindi"),
         InlineKeyboardButton("ЁЯЗ║ЁЯЗ╕ English", callback_data="lang_english")],
        [InlineKeyboardButton("ЁЯЗ╡ЁЯЗ░ Urdu", callback_data="lang_urdu"),
         InlineKeyboardButton("ЁЯЗиЁЯЗ│ Chinese", callback_data="lang_chinese")],
        [InlineKeyboardButton("ЁЯЗлЁЯЗ╖ French", callback_data="lang_french"),
         InlineKeyboardButton("ЁЯЗкЁЯЗ╕ Spanish", callback_data="lang_spanish")],
        [InlineKeyboardButton("ЁЯЗ╣ЁЯЗ╖ Turkish", callback_data="lang_turkish")]
    ])
    
    await update.message.reply_text(
        "ЁЯМР рдЕрдкрдиреА рднрд╛рд╖рд╛ рдЪреБрдиреЗрдВ / Select Your Language:",
        reply_markup=keyboard,
        parse_mode="HTML"
    )

async def language_selected(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    query = update.callback_query
    await query.answer()
    user_id = str(query.from_user.id)
    lang = query.data.replace("lang_", "")

    user_lang[user_id] = lang
    
    welcome_msg = LANGUAGES.get(lang, LANGUAGES["english"])["welcome"]
    full_welcome = LANGUAGES.get(lang, LANGUAGES["english"])["full_welcome"]
    
    await query.edit_message_text(
        get_message(user_id, "language_set", message=welcome_msg),
        parse_mode="HTML"
    )
    await context.bot.send_message(
        chat_id=int(user_id),
        text=full_welcome,
        parse_mode="HTML"
    )

async def change_language(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user_id = str(update.effective_user.id)
    
    if is_banned(user_id):
        await update.message.reply_text(get_message(user_id, "banned"))
        return

    keyboard = InlineKeyboardMarkup([
        [InlineKeyboardButton("ЁЯЗоЁЯЗ│ Hindi", callback_data="lang_hindi"),
         InlineKeyboardButton("ЁЯЗ║ЁЯЗ╕ English", callback_data="lang_english")],
        [InlineKeyboardButton("ЁЯЗ╡ЁЯЗ░ Urdu", callback_data="lang_urdu"),
         InlineKeyboardButton("ЁЯЗиЁЯЗ│ Chinese", callback_data="lang_chinese")],
        [InlineKeyboardButton("ЁЯЗлЁЯЗ╖ French", callback_data="lang_french"),
         InlineKeyboardButton("ЁЯЗкЁЯЗ╕ Spanish", callback_data="lang_spanish")],
        [InlineKeyboardButton("ЁЯЗ╣ЁЯЗ╖ Turkish", callback_data="lang_turkish")]
    ])
    
    await update.message.reply_text(
        "ЁЯМР рдЕрдкрдиреА рднрд╛рд╖рд╛ рдЪреБрдиреЗрдВ / Select Your Language:",
        reply_markup=keyboard,
        parse_mode="HTML"
    )

async def user_dashboard(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user = update.effective_user
    user_id = str(user.id)
    lang = get_user_language(user_id)
    banned = "Yes ЁЯЪл" if is_banned(user_id) else "No тЬЕ"
    total = len(user_lang)

    await update.message.reply_text(
        get_message(user_id, "user", user_id=user_id, lang=lang.capitalize(), banned=banned, total=total),
        parse_mode="HTML"
    )

async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user_id = str(update.effective_user.id)
    await update.message.reply_text(
        get_message(user_id, "help"),
        parse_mode="HTML"
    )

async def feedback_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user_id = str(update.effective_user.id)
    
    if is_banned(user_id):
        await update.message.reply_text(get_message(user_id, "banned"))
        return

    await update.message.reply_text(
        get_message(user_id, "welcome"),
        parse_mode="HTML"
    )

async def commands_list(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user_id = str(update.effective_user.id)
    await update.message.reply_text(
        get_message(user_id, "commands"),
        parse_mode="HTML"
    )

# -------------------- ADMIN COMMANDS --------------------
async def ban_user(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    admin_id = str(update.effective_user.id)
    
    if not is_admin(admin_id):
        await update.message.reply_text(get_message(admin_id, "unauthorized"))
        return

    if not context.args:
        await update.message.reply_text("тЪая╕П Usage: /ban <user_id>")
        return
    
    user_id = context.args[0]
    banned_users.add(user_id)
    await update.message.reply_text(get_message(admin_id, "ban_success", user_id=user_id))

async def unban_user(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    admin_id = str(update.effective_user.id)
    
    if not is_admin(admin_id):
        await update.message.reply_text(get_message(admin_id, "unauthorized"))
        return

    if not context.args:
        await update.message.reply_text("тЪая╕П Usage: /unban <user_id>")
        return
    
    user_id = context.args[0]
    banned_users.discard(user_id)
    await update.message.reply_text(get_message(admin_id, "unban_success", user_id=user_id))

async def broadcast(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    admin_id = str(update.effective_user.id)
    
    if not is_admin(admin_id):
        await update.message.reply_text(get_message(admin_id, "unauthorized"))
        return

    if not update.message.reply_to_message and not context.args:
        await update.message.reply_text("тЪая╕П Usage: Reply to a message or type /broadcast <message>")
        return
    
    msg = update.message.reply_to_message if update.message.reply_to_message else update.message
    msg_text = " ".join(context.args) if context.args else None
    
    count = 0
    failed = 0
    
    for uid in list(user_lang.keys()):
        try:
            if update.message.reply_to_message:
                await context.bot.copy_message(
                    chat_id=int(uid),
                    from_chat_id=update.message.chat_id,
                    message_id=msg.message_id
                )
            else:
                await context.bot.send_message(
                    chat_id=int(uid),
                    text=msg_text
                )
            count += 1
        except Exception as e:
            failed += 1
            logger.warning(f"Broadcast to {uid} failed: {e}")
    
    await update.message.reply_text(
        get_message(admin_id, "broadcast_result", count=count, failed=failed)
    )

# -------------------- MESSAGE HANDLERS --------------------
async def handle_user_message(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user = update.effective_user
    user_id = str(user.id)

    if is_banned(user_id):
        await update.message.reply_text(get_message(user_id, "banned"))
        return
    
    for admin_id in ADMIN_IDS:
        try:
            if update.message.text:
                sent = await context.bot.send_message(
                    chat_id=int(admin_id),
                    text=(
                        f"ЁЯУй From: {user.full_name} (@{user.username or 'NoUsername'})\n"
                        f"ЁЯЖФ ID: {user.id}\n\n"
                        f"ЁЯУЭ {update.message.text}"
                    ),
                    parse_mode="HTML"
                )
            else:
                sent = await context.bot.forward_message(
                    chat_id=int(admin_id),
                    from_chat_id=user.id,
                    message_id=update.message.message_id
                )
            forward_map[sent.message_id] = user.id
        except Exception as e:
            logger.error(f"Forward Error to admin {admin_id}: {e}")

async def handle_admin_reply(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    admin_id = str(update.effective_user.id)
    
    if not is_admin(admin_id):
        await update.message.reply_text(get_message(admin_id, "unauthorized"))
        return

    msg = update.message
    if not msg.reply_to_message:
        await update.message.reply_text(get_message(admin_id, "reply_instructions"))
        return
    
    reply_msg_id = msg.reply_to_message.message_id
    user_id = forward_map.get(reply_msg_id)
    
    if not user_id:
        await update.message.reply_text(get_message(admin_id, "user_not_found"))
        return
    
    try:
        prefix = get_message(admin_id, "admin_reply_prefix")
        kwargs = {"chat_id": user_id, "parse_mode": "HTML"}
        
        if msg.text:
            await context.bot.send_message(text=prefix + msg.text, **kwargs)
        elif msg.photo:
            await context.bot.send_photo(
                photo=msg.photo[-1].file_id,
                caption=prefix + (msg.caption or ""),
                **kwargs
            )
        elif msg.document:
            await context.bot.send_document(
                document=msg.document.file_id,
                caption=prefix + (msg.caption or ""),
                **kwargs
            )
        elif msg.video:
            await context.bot.send_video(
                video=msg.video.file_id,
                caption=prefix + (msg.caption or ""),
                **kwargs
            )
        elif msg.audio:
            await context.bot.send_audio(
                audio=msg.audio.file_id,
                caption=prefix + (msg.caption or ""),
                **kwargs
            )
        elif msg.voice:
            await context.bot.send_voice(
                voice=msg.voice.file_id,
                caption=prefix + (msg.caption or ""),
                **kwargs
            )
        elif msg.sticker:
            await context.bot.send_sticker(
                chat_id=user_id,
                sticker=msg.sticker.file_id
            )
        else:
            await update.message.reply_text(get_message(admin_id, "invalid_format"))
            return
        
        await update.message.reply_text(get_message(admin_id, "reply_success"))
    except Exception as e:
        logger.error(f"Reply Error: {e}")
        await update.message.reply_text(get_message(admin_id, "reply_failed"))

# -------------------- MAIN FUNCTION --------------------
def main() -> None:
    """Start the bot."""
    application = ApplicationBuilder().token(TOKEN).build()

    # Command handlers
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("user", user_dashboard))
    application.add_handler(CommandHandler("language", change_language))
    application.add_handler(CommandHandler("help", help_command))
    application.add_handler(CommandHandler("feedback", feedback_command))
    application.add_handler(CommandHandler("commands", commands_list))
    
    # Admin command handlers
    application.add_handler(CommandHandler("ban", ban_user))
    application.add_handler(CommandHandler("unban", unban_user))
    application.add_handler(CommandHandler("broadcast", broadcast))

    # Callback handlers
    application.add_handler(CallbackQueryHandler(language_selected, pattern="^lang_"))

    # Message handlers
    application.add_handler(MessageHandler(filters.ChatType.PRIVATE & filters.REPLY, handle_admin_reply))
    application.add_handler(MessageHandler(filters.ChatType.PRIVATE & ~filters.COMMAND, handle_user_message))

    # Start the Bot
    application.run_polling()
    logger.info("Bot started and running...")

if __name__ == "__main__":
    main()